<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Working with folders | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Working with folders | PnP Core SDK ">
    <meta name="generator" content="docfx 2.59.2.0">
    <meta name="description" content="The PnP Core SDK is a modern .NET SDK designed to work for Microsoft 365. It provides a unified object model for working with SharePoint Online and Teams which is agnostic to the underlying API's being called.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/pnpcore/blob/dev/docs/using-the-sdk/folders-intro.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="working-with-folders">Working with folders</h1>

<p>A list or library can use folders to build a structure to manage the list items or files. Folders can also exist at the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html">IWeb</a> level, so outside the context of a list or library.</p>
<p>In the remainder of this article you'll see a lot of <code>context</code> use: in this case this is a <code>PnPContext</code> which was obtained via the <code>PnPContextFactory</code> as explained in the <a href="readme.html">overview article</a> and show below:</p>
<pre><code class="lang-csharp">using (var context = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    // See next chapter on how to use the PnPContext for working with folders
}
</code></pre>
<h2 id="getting-folders">Getting folders</h2>
<p>Lists and libraries do have a <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#PnP_Core_Model_SharePoint_IList_RootFolder">RootFolder property</a> allowing you to enumerate content inside, but also the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html">IWeb</a> has a <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#PnP_Core_Model_SharePoint_IWeb_Folders">collection of Folders</a>, a <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#collapsible-PnP_Core_Model_SharePoint_IWeb_RootFolder">RootFolder</a> and <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#collapsible-PnP_Core_Model_SharePoint_IWeb_GetFolderByIdAsync_Guid_Expression_Func_PnP_Core_Model_SharePoint_IFolder_System_Object_____">GetFolderByIdAsync</a> and <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#collapsible-PnP_Core_Model_SharePoint_IWeb_GetFolderByServerRelativeUrlAsync_System_String_Expression_Func_PnP_Core_Model_SharePoint_IFolder_System_Object_____">GetFolderByServerRelativeUrlAsync</a> methods. All of these approach either give you an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFolder.html">IFolder</a> or an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFolderCollection.html">IFolderCollection</a> that you can use to work with.</p>
<pre><code class="lang-csharp">// Get a folder by loading it via it's server relative url
var folder = await context.Web.GetFolderByServerRelativeUrlAsync($&quot;{context.Uri.PathAndQuery}/SiteAssets&quot;); 

// Get a folder by id
var folder = await context.Web.GetFolderByIdAsync(new Guid(&quot;d50ec969-cb27-4a49-839f-3c25d1d607d5&quot;)); 

// Get a folder via the list
var folder = (await context.Web.Lists.GetByTitleAsync(&quot;Documents&quot;, p =&gt; p.RootFolder)).RootFolder;

// Get root folder of a library
IFolder folder = await context.Web.Folders.Where(f =&gt; f.Name == &quot;SiteAssets&quot;).FirstOrDefaultAsync();

// Get root folder of the web (for files living outside of a document library)
IFolder folder = (await context.Web.GetAsync(p =&gt; p.RootFolder)).RootFolder;

// Get folder collection of a web and pick the SiteAssets folder
await context.Web.LoadAsync(p =&gt; p.Folders);
var folder = context.Web.Folders.AsRequested().FirstOrDefault(p=&gt;p.Name == &quot;SiteAssets&quot;);
</code></pre>
<h3 id="the-folder-property-bag">The Folder property bag</h3>
<p>Each folder also has a so called property bag, a list key/value pairs providing more information about the folder. You can read this property bag, provided via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFolder.html#PnP_Core_Model_SharePoint_IFolder_Properties">IFolder Properties property</a>, and add new key/value pairs to it.</p>
<pre><code class="lang-csharp">// Get a folder by loading it via it's server relative url, also load the properties (= property bag)
var folder = await context.Web.GetFolderByServerRelativeUrlAsync($&quot;{context.Uri.PathAndQuery}/SiteAssets&quot;, f =&gt; f.Properties); 

// Enumerate the folder property bag
foreach(var property in folder.Properties)
{
    // Do something with the property
}

// Add a new property
folder[&quot;myPropertyKey&quot;] = &quot;Some value&quot;;
await folder.Properties.UpdateAsync();
</code></pre>
<h2 id="adding-folders">Adding folders</h2>
<p>When working with folders there always is a root folder or folder collection present, a web has a root folder and folders collection and lists and libraries have a root folder. Adding folders implies adding folder as sub folder of an existing folder and this can be done by adding a new IFolder into an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFolderCollection.html">IFolderCollection</a> by using the Add methods or using <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFolder.html#PnP_Core_Model_SharePoint_IFolder_EnsureFolderAsync_System_String_">EnsureFolderAsync</a>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Before you can add folders to a list the list needs to be enabled for folder creation by setting the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#PnP_Core_Model_SharePoint_IList_EnableFolderCreation">EnableFolderCreation property</a> to true.</p>
</div>
<pre><code class="lang-csharp">// Get the root folder of the Documents library
var folder = (await context.Web.Lists.GetByTitleAsync(&quot;Documents&quot;, p =&gt; p.RootFolder)).RootFolder;

// Add a folder 
var subFolder = await folder.Folders.AddAsync(&quot;My folder&quot;);
</code></pre>
<h3 id="ensure-a-folder-path">Ensure a folder path</h3>
<p>When adding folders a very convenient method to use is the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFolder.html#PnP_Core_Model_SharePoint_IFolder_EnsureFolderAsync_System_String_">EnsureFolderAsync</a> method as this one can take a folder path and verify each part of the path and create it if needed.</p>
<pre><code class="lang-csharp">// Get the root folder of the Site Pages library
IFolder folder = (await context.Web.Lists.GetByTitleAsync(&quot;Site Pages&quot;, p =&gt; p.RootFolder)).RootFolder;

// Below command will result in a folder hierarchy sub1/sub2/sub3/sub4/sub5, 5 levels deep
var subFolder = await folder.EnsureFolderAsync(&quot;sub1/sub2/sub3/sub4/sub5&quot;);
</code></pre>
<h2 id="adding-content-in-folders">Adding content in folders</h2>
<p>Folders can contain other folders, but the common use case for folders is to hold files, see the <a href="files-intro.html">Files documentation</a> to learn how to add a file into a folder.</p>
<h2 id="updating-folders">Updating folders</h2>
<p>All but one IFolder properties are readonly, the only one that can be set is the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFolder.html#collapsible-PnP_Core_Model_SharePoint_IFolder_WelcomePage">WelcomePage property</a> and setting this property only makes sense on the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#collapsible-PnP_Core_Model_SharePoint_IWeb_RootFolder">web's RootFolder</a> as that property determines the web's home page to load.</p>
<pre><code class="lang-csharp">// Check if the RootFolder property was loaded, if not request it from the server
await context.Web.EnsurePropertiesAsync(p =&gt; p.RootFolder);

// Set the WelcomePage and update the folder
context.Web.RootFolder.WelcomePage = &quot;sitepages/myhomepage.aspx&quot;;
await context.Web.RootFolder.UpdateAsync();
</code></pre>
<h2 id="renaming-folders">Renaming folders</h2>
<p>To rename a folder you can either use the <code>Rename</code> methods or use the <code>MoveTo</code> methods.</p>
<pre><code class="lang-csharp">string folderUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/Test&quot;;

// Get a reference to the folder
IFolder folder = await context.Web.GetFolderByServerRelativeUrlAsync(folderUrl);

// Option A: Use the Rename methods
await testFolder.RenameAsync(&quot;Test2&quot;);

// Option B: Move the folder to rename it
await testFolder.MoveToAsync($&quot;{context.Uri.PathAndQuery}/Shared Documents/Test2&quot;);
</code></pre>
<h2 id="deleting-folders">Deleting folders</h2>
<pre><code class="lang-csharp">// Get the root folder of the Site Pages library
IFolder folder = (await context.Web.Lists.GetByTitleAsync(&quot;Site Pages&quot;, p =&gt; p.RootFolder)).RootFolder;

// Add a folder 
var subFolder = await folder.Folders.AddAsync(&quot;My folder&quot;);

// Delete the folder again
await subFolder.DeleteAsync();
</code></pre>
<h2 id="sharing-folders">Sharing folders</h2>
<p>A folder can be shared with your organization, with specific users or with everyone (anonymous), obviously all depending on how the sharing configuration of your tenant and site collection. Check out the <a href="sharing-intro.html">PnP Core SDK Sharing APIs</a> to learn more on how you can share a folder.</p>
<h2 id="getting-changes-for-a-folder">Getting changes for a folder</h2>
<p>You can use the <code>GetChanges</code> methods on an <code>IFolder</code> to list all the changes. See <a href="changes-sharepoint.html">Enumerating changes that happened in SharePoint</a> to learn more.</p>
<h2 id="copying-or-moving-folders">Copying or moving folders</h2>
<p>A folder can be copied or moved into another SharePoint location and this can be done using the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_CopyToAsync_System_String_System_Boolean_PnP_Core_Model_SharePoint_MoveCopyOptions_">CopyToAsync</a> and <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_MoveToAsync_System_String_PnP_Core_Model_SharePoint_MoveOperations_PnP_Core_Model_SharePoint_MoveCopyOptions_">MoveToAsync</a> methods.</p>
<pre><code class="lang-csharp">string folderUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/customFolder&quot;;

// Get a reference to the folder
IFolder testFolder = await context.Web.GetFolderByServerRelativeUrlAsync(folderUrl);

// Copy the Folder
await testFolder.CopyToAsync($&quot;{context.Uri.PathAndQuery}/MyFolder&quot;);

// Move the folder
await testFolder.MoveToAsync($&quot;{context.Uri.PathAndQuery}/MyFolder&quot;);

// Move the folder with options
await testFolder.MoveToAsync($&quot;{context.Uri.PathAndQuery}/MyFolder&quot;,
                            new MoveCopyOptions 
                            { 
                                KeepBoth = false
                            });
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>To copy or move a folder you can use an asynchronous bulk file/folder copy/move via the <code>CreateCopyJobs</code> methods on <code>ISite</code>. See <a href="sites-copymovecontent.html">here</a> for more details.</p>
</div>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>    
    <img src="https://m365-visitor-stats.azurewebsites.net/pnpcoresdk/docs">
  </body>
</html>