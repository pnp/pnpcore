<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Working with files | PnP Core SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Working with files | PnP Core SDK ">
    <meta name="generator" content="docfx 2.56.5.0">
    <meta name="description" content="The PnP Core SDK is an SDK designed to work against Microsoft 365. Its aim is to provide a unified object model to work with the whole Microsoft 365 ecosystem. ">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/pnpcore/blob/dev/docs/using-the-sdk/files-intro.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="working-with-files">Working with files</h1>

<p>Working with files (documents) is a core aspect of working with SharePoint. Learn how to add/upload files, set metadata and download files again and much more.</p>
<p>In the remainder of this article you'll see a lot of <code>context</code> use: in this case this is a <code>PnPContext</code> which was obtained via the <code>PnPContextFactory</code> as explained in the <a href="readme.html">overview article</a> and show below:</p>
<pre><code class="lang-csharp">using (var context = await pnpContextFactory.CreateAsync(&quot;SiteToWorkWith&quot;))
{
    // See next chapter on how to use the PnPContext for working with files
}
</code></pre>
<h2 id="getting-files">Getting files</h2>
<p>In PnP Core SDK files are represented via an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html">IFile interface</a>. Before you get perform a file operation (e.g. like publish or download) you need to get the file as <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html">IFile</a>. There are a number of ways to get an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html">IFile</a> like loading a single file via a lookup or enumerating the files in library / folder.</p>
<h3 id="getting-a-single-file">Getting a single file</h3>
<p>If you know the name and location of a file you can get a reference to it via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html">IWeb</a> method named <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#collapsible-PnP_Core_Model_SharePoint_IWeb_GetFileByServerRelativeUrlAsync_System_String_Expression_Func_PnP_Core_Model_SharePoint_IFile_System_Object_____">GetFileByServerRelativeUrl</a>. This method takes a server relative path of the file and optionally allows you to specify which properties to load on the file.</p>
<pre><code class="lang-csharp">string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Get a reference to the file
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl);

// Get a reference to the file, loading extra properties of the IFile 
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl, f =&gt; f.CheckOutType, f =&gt; f.CheckedOutByUser);
</code></pre>
<h3 id="getting-the-file-of-a-list-item">Getting the file of a list item</h3>
<p>A document in a document library is an <code>IListItem</code> holding the file metadata with an <code>IFile</code> holding the actual file. If you have an <code>IListItem</code> you can load the connected file via <code>File</code> property:</p>
<pre><code class="lang-csharp">var myList = await context.Web.Lists.GetByTitleAsync(&quot;My List&quot;);

// Load list item with id 1 with it's file
var first = await myList.Items.GetByIdAsync(1, li =&gt; li.All, li =&gt; li.File);

// Use the loaded IFile, e.g. for downloading it
byte[] downloadedContentBytes = await first.File.GetContentBytesAsync();
</code></pre>
<h3 id="enumerating-files">Enumerating files</h3>
<p>Files do live in an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFolder.html">IFolder</a>, document libraries do have a <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#PnP_Core_Model_SharePoint_IList_RootFolder">RootFolder property</a> allowing you to enumerate files, but also the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html">IWeb</a> has a <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#PnP_Core_Model_SharePoint_IWeb_Folders">collection of Folders</a>, a <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#collapsible-PnP_Core_Model_SharePoint_IWeb_RootFolder">RootFolder</a> and <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#collapsible-PnP_Core_Model_SharePoint_IWeb_GetFolderByIdAsync_Guid_Expression_Func_PnP_Core_Model_SharePoint_IFolder_System_Object_____">GetFolderByIdAsync</a> and <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IWeb.html#collapsible-PnP_Core_Model_SharePoint_IWeb_GetFolderByServerRelativeUrlAsync_System_String_Expression_Func_PnP_Core_Model_SharePoint_IFolder_System_Object_____">GetFolderByServerRelativeUrlAsync</a> methods. Once you've a folder you can enumerate the files inside it.</p>
<pre><code class="lang-csharp">// Get root folder of a library
IFolder folder = await context.Web.Folders.GetFirstOrDefaultAsync(f =&gt; f.Name == &quot;SiteAssets&quot;);

// Get root folder of the web (for files living outside of a document library)
IFolder folder = (await context.Web.GetAsync(p =&gt; p.RootFolder)).RootFolder;

// Get folder collection of a web and pick the SiteAssets folder
await context.Web.LoadAsync(p =&gt; p.Folders);
var folder = context.Web.Folders.AsRequested().FirstOrDefault(p=&gt;p.Name == &quot;SiteAssets&quot;);

// Load files property of the folder
await folder.LoadAsync(p =&gt; p.Files);

foreach(var file in folder.Files.AsRequested())
{
    // Do something with the file
}
</code></pre>
<h2 id="getting-file-properties">Getting file properties</h2>
<p>A file in SharePoint has properties which can be requested by loading them on the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html">IFile</a>. Below snippet shows some ways on how to load file properties.</p>
<pre><code class="lang-csharp">string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Sample 1: Get a reference to the file
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl);

// Sample 2: Get a reference to the file, loading the file Author and ModifiedBy properties
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl, w =&gt; w.Author, w =&gt; w.ModifiedBy);

// Sample 3: Get files by loading it's folder and the containing files with their selected properties
var folder = await context.Web.GetFolderByServerRelativeUrlAsync($&quot;{context.Uri.PathAndQuery}/SiteAssets&quot;, 
                    p =&gt; p.Name, p =&gt; p.Files.QueryProperties(p =&gt; p.Name, p =&gt; p.Author, p =&gt; p.ModifiedBy));
foreach(var file in folder.Files.AsRequested())
{
    // Do something with the file, properties Name, Author and ModifiedBy are loaded
}
</code></pre>
<h3 id="file-property-bag">File property bag</h3>
<p>Each file also has a so called property bag, a list key/value pairs providing more information about the file. You can read this property bag, provided via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#collapsible-PnP_Core_Model_SharePoint_IFile_Properties">IFile Properties property</a>, and add new key/value pairs to it.</p>
<pre><code class="lang-csharp">string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Get a reference to the file, load the file property bag
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl, f =&gt; f.Properties);

// Enumerate the file property bag
foreach(var property in testDocument.Properties)
{
    // Do something with the property
}

// Add a new property
testDocument[&quot;myPropertyKey&quot;] = &quot;Some value&quot;;
await testDocument.Properties.UpdateAsync();
</code></pre>
<h2 id="publishing-and-un-publishing-files">Publishing and un-publishing files</h2>
<p>Publishing a file will move the file from draft into published status and increase it's major version by one. Publishing can be done using the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_PublishAsync_System_String_">PublishAsync method</a>, un-publishing a file will bring the file back to draft status and can be done using the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_UnpublishAsync_System_String_">UnPublishAsync method</a>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Publishing a file requires the library to be configured to support major versions. See the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#PnP_Core_Model_SharePoint_IList_EnableVersioning">EnableVersioning property on the IList interface</a>.</p>
</div>
<pre><code class="lang-csharp">string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Get a reference to the file, load the file property bag
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl);

// Publish the file
await testDocument.PublishAsync(&quot;Optional publish message&quot;);

// Un-publish the file
await testDocument.UnpublishAsync(&quot;Optional un-publish message&quot;);
</code></pre>
<h2 id="checking-out-undoing-check-out-and-checking-in-files">Checking out, undoing check out and checking in files</h2>
<p>In SharePoint a file can be checked out by a user to &quot;lock&quot; the file and then later on checked in again. The same can be done using code, including undoing a checked out of another user via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_CheckoutAsync">CheckoutAsync</a>, <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_CheckinAsync_System_String_PnP_Core_Model_SharePoint_CheckinType_">CheckinAsync</a> and <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_UndoCheckoutAsync">UndoCheckout</a> methods.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Publishing a file requires the library to be configured to support major versions. See the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#collapsible-PnP_Core_Model_SharePoint_IList_ForceCheckout">ForceCheckout property on the IList interface</a>.</p>
</div>
<pre><code class="lang-csharp">string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Get a reference to the file
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl);

// Check out the file
await testDocument.CheckoutAsync();

// Check in the file
await testDocument.CheckinAsync();
</code></pre>
<p>Undoing a checkout:</p>
<pre><code class="lang-csharp">// Get the default document library root folder
string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Get a reference to the file, load the check out information as that can be needed before undoing the check out
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl, f =&gt; f.CheckOutType, f =&gt; f.CheckedOutByUser);

// Checkout the file
await testDocument.UndoCheckoutAsync();
</code></pre>
<h2 id="deleting-and-recycling-files">Deleting and recycling files</h2>
<p>You can delete a file (permanent operation) or move it to the site's recycle bin (the file can be restored). Deleting a file is done using the typical Delete methods like <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.IDataModelDelete.html#PnP_Core_Model_IDataModelDelete_DeleteAsync">DeleteAsync</a>, recycling is done via <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_RecycleAsync">RecycleAsync</a>.</p>
<pre><code class="lang-csharp">string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Get a reference to the file
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl);

// Recycle the file
await testDocument.RecycleAsync();

// Delete the file
await testDocument.DeleteAsync();
</code></pre>
<h2 id="adding-files-uploading">Adding files (=uploading)</h2>
<p>Adding a file comes down to create a file reference and uploading the file's bytes and this can be done via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFileCollection.html#PnP_Core_Model_SharePoint_IFileCollection_AddAsync_System_String_Stream_System_Boolean_">AddAsync method on a Files collection</a>. This method takes a stream of bytes as input for the file contents.</p>
<div class="NOTE">
<h5>Note</h5>
<p>See the <a href="files-large.html">working with large files</a> page for some more complete file upload/download samples.</p>
</div>
<pre><code class="lang-csharp">// Get a reference to a folder
IFolder siteAssetsFolder = await context.Web.Folders.Where(f =&gt; f.Name == &quot;SiteAssets&quot;).FirstOrDefaultAsync();

// Upload a file by adding it to the folder's files collection
IFile addedFile = await siteAssetsFolder.Files.AddAsync(&quot;test.docx&quot;, 
                  System.IO.File.OpenRead($&quot;.{Path.DirectorySeparatorChar}TestFilesFolder{Path.DirectorySeparatorChar}test.docx&quot;));
</code></pre>
<h2 id="updating-file-metadata">Updating file metadata</h2>
<p>The library in which you've uploaded a file might have additional columns to store metadata about the file. To update this metadata you first need to load the <code>IListItem</code> linked to the added file via the <code>ListItemAllFields</code> property, followed by setting the metadata and updating the <code>IListItem</code>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>See the <a href="listitems-intro.html">working with list items</a> page for information on how to update an <code>IListItem</code>.</p>
</div>
<pre><code class="lang-csharp">// Get a reference to a folder
IFolder documentsFolder = await context.Web.Folders.Where(f =&gt; f.Name == &quot;Documents&quot;).FirstOrDefaultAsync();

// Upload a file by adding it to the folder's files collection
IFile addedFile = await documentsFolder.Files.AddAsync(&quot;test.docx&quot;, 
                  System.IO.File.OpenRead($&quot;.{Path.DirectorySeparatorChar}TestFilesFolder{Path.DirectorySeparatorChar}test.docx&quot;));
// Load the corresponding ListItem
await addedFile.ListItemAllFields.LoadAsync();
// Set the metadata
addedFile.ListItemAllFields[&quot;Field1&quot;] = &quot;Hi there&quot;;
addedFile.ListItemAllFields[&quot;Field2&quot;] = true;
// Persist the ListItem changes
await addedFile.ListItemAllFields.UpdateAsync();
</code></pre>
<h2 id="downloading-files">Downloading files</h2>
<p>If you want to download a file you do need to use either the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_GetContentAsync_System_Boolean_">GetContentAsync method</a> if you prefer a Stream as result type or <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#collapsible-PnP_Core_Model_SharePoint_IFile_GetContentBytesAsync">GetContentBytesAsync</a> if you prefer a byte array.</p>
<div class="NOTE">
<h5>Note</h5>
<p>See the <a href="files-large.html">working with large files</a> page for some more complete file upload/download samples.</p>
</div>
<pre><code class="lang-csharp">string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Get a reference to the file
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl);

// Download the file as stream
Stream downloadedContentStream = await testDocument.GetContentAsync();

// Download the file as an array of bytes
byte[] downloadedContentBytes = await testDocument.GetContentBytesAsync();
</code></pre>
<h2 id="copying-and-moving-files">Copying and moving files</h2>
<p>A file can be copied or moved into another SharePoint location and this can be done using the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_CopyToAsync_System_String_System_Boolean_PnP_Core_Model_SharePoint_MoveCopyOptions_">CopyToAsync</a> and <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_MoveToAsync_System_String_PnP_Core_Model_SharePoint_MoveOperations_PnP_Core_Model_SharePoint_MoveCopyOptions_">MoveToAsync</a> methods.</p>
<pre><code class="lang-csharp">string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Get a reference to the file
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl);

// Copy the file, overwrite if existing on the destination
await testDocument.CopyToAsync($&quot;{context.Uri.PathAndQuery}/MyDocuments/document.docx&quot;, true);

// Move the file, overwrite if needed
await testDocument.MoveToAsync($&quot;{context.Uri.PathAndQuery}/MyDocuments/document.docx&quot;, MoveOperations.Overwrite);
</code></pre>
<h2 id="getting-file-versions">Getting file versions</h2>
<p>When versioning on a file is enabled a file can have multiple versions and PnP Core SDK can be used to work with the older file versions. Each file version is represented via an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFileVersion.html">IFileVersion</a> in an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFileVersionCollection.html">IFileVersionCollection</a>. Loading file versions can be done by requesting the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_Versions">Versions property</a> of the file. Once you've an <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFileVersion.html">IFileVersion</a> you can also download that specific version of the file by using one of the GetContent methods as shown in the example.</p>
<div class="NOTE">
<h5>Note</h5>
<p>For a file to have versions the library needs to be configured to support major versions and/or minor versions. See the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#PnP_Core_Model_SharePoint_IList_EnableVersioning">EnableVersioning</a> and <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#PnP_Core_Model_SharePoint_IList_EnableMinorVersions">EnableMinorVersions</a> properties on the IList interface.</p>
</div>
<pre><code class="lang-csharp">string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Get a reference to the file, also request the Versions property
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl, f =&gt; f.Versions);

foreach(var fileVersion in testDocument.Versions)
{
    // Download the file version content as stream
    Stream fileVersionContent = await fileVersion.GetContentAsync();
}
</code></pre>
<h2 id="getting-file-irm-settings">Getting file IRM settings</h2>
<p>A SharePoint document library can be configured with an <a href="https://docs.microsoft.com/en-us/microsoft-365/compliance/set-up-irm-in-sp-admin-center?view=o365-worldwide">Information Rights Management (IRM) policy</a> which then stamps an IRM policy on the documents obtained from that library. Use the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IFile.html#PnP_Core_Model_SharePoint_IFile_InformationRightsManagementSettings">InformationRightsManagementSettings</a> property to read the file's IRM settings.</p>
<div class="NOTE">
<h5>Note</h5>
<p>The library holding files you want to protect need to be first setup for IRM by enabling IRM on it via the <a href="https://pnp.github.io/pnpcore/api/PnP.Core.Model.SharePoint.IList.html#collapsible-PnP_Core_Model_SharePoint_IList_IrmEnabled">IrmEnabled property</a>.</p>
</div>
<pre><code class="lang-csharp">string documentUrl = $&quot;{context.Uri.PathAndQuery}/Shared Documents/document.docx&quot;;

// Get a reference to the file, also request the Versions property
IFile testDocument = await context.Web.GetFileByServerRelativeUrlAsync(documentUrl, f =&gt; f.InformationRightsManagementSettings);

var fileAccessExpirationTimeInDays = testDocument.InformationRightsManagementSettings.DocumentAccessExpireDays;
</code></pre>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>PnP Core SDK<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>